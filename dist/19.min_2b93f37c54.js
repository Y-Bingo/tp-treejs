"use strict";(self.webpackChunktp_threejs=self.webpackChunktp_threejs||[]).push([[19,37],{752:(e,t,n)=>{n.d(t,{a:()=>a});var i=n(2212),s=n(5357);class a{constructor(e){this.appId="00",this.appName="BASE",this.width=s.c.width,this.height=s.c.height,this.canvas=null,this.viewCenter=new i.pc(0,0,0),this.handle=-1,this.canvas=e}initRender(){const e=new i.rc({antialias:!0,canvas:this.canvas});e.setSize(this.width,this.height),e.setClearColor("#000000",1),e.setPixelRatio(window.devicePixelRatio),this.renderer=e}initScene(){const e=new i.Qb;this.scene=e}initCamera(){}initLight(){}initModel(){}onCreating(){}onCreated(){}onRender(){}onDestroy(){}onResize(){}create(){this.onCreating(),this.initRender(),this.initScene(),this.initCamera(),this.initLight(),this.initModel(),this.onCreated()}render(){var e;null===(e=this.renderer)||void 0===e||e.clear(),this.onRender(),this.handle=requestAnimationFrame(this.render.bind(this))}run(){this.create(),this.render()}resize(){var e,t;this.width=window.innerWidth,this.height=window.innerHeight,this.camera&&this.camera instanceof i.zb&&(this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()),null===(e=this.renderer)||void 0===e||e.setSize(this.width,this.height),null===(t=this.renderer)||void 0===t||t.setPixelRatio(Math.min(2,window.devicePixelRatio)),this.onResize()}destroy(){this.onDestroy(),this.scene.clear(),this.renderer.clear(),cancelAnimationFrame(this.handle),console.log(`销毁应用【${this.appId} ${this.appName}】`)}}},7079:(e,t,n)=>{n.r(t),n.d(t,{BaseJourney:()=>s});var i=n(752);class s extends i.a{}},2459:(e,t,n)=>{n.r(t),n.d(t,{Journey34:()=>l});var i=n(4376),s=n(6358),a=n(2212),r=n(9365),o=n(2854),h=n(1217),d=n(7079);const c=document.createElement("div");c.classList.add("loading-bar");class l extends d.BaseJourney{constructor(){super(...arguments),this.lastTimeStamp=0}onCreating(){this.params={envMapIntensity:5},this.clock=new a.r,this.gui=new i.a,document.body.appendChild(c)}onCreated(){this.controls=new r.a(this.camera,this.canvas),this.controls.enableDamping=!0,this.renderer.physicallyCorrectLights=!0,this.renderer.outputEncoding=a.sc,this.renderer.toneMapping=a.a,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=a.yb;const e=new a.Ab(2,2,1,1),t=new a.Rb({uniforms:{uAlpha:{value:1}},transparent:!0,vertexShader:"\n                void main(){\n                    gl_Position = vec4(position, 1.0);\n                }\n            ",fragmentShader:"\n                uniform float uAlpha;\n                void main(){\n                    gl_FragColor = vec4(0.0, 0.0, 0.0, uAlpha);\n                }\n            "}),n=new a.nb(e,t);this.overlayPanel=n,this.scene.add(n)}initLight(){const e=new a.y(16777215,3);e.position.set(.25,3,-2.25),e.shadow.mapSize.set(1024,1024),e.castShadow=!0,e.shadow.normalBias=.05,this.scene.add(e)}initCamera(){const e=new a.zb(75,this.width/this.height,.1,100);e.position.set(-7,7,7),this.camera=e,this.scene.add(e)}initModel(){const e=this.scene,t=new a.bb((()=>{s.b.delayedCall(.5,(()=>{s.b.to(this.overlayPanel.material.uniforms.uAlpha,{duration:3,value:0}),c.style.transform="",c.classList.add("ended")}))}),((e,t,n)=>{const i=t/n;c.style.transform=`scaleX(${i})`})),n=new a.u(t),i=new o.a;i.setDecoderPath("resource/draco/");const r=new h.a(t);r.setDRACOLoader(i);const d=n.load(["resource/journey/environmentMaps/3/px.jpg","resource/journey/environmentMaps/3/nx.jpg","resource/journey/environmentMaps/3/py.jpg","resource/journey/environmentMaps/3/ny.jpg","resource/journey/environmentMaps/3/pz.jpg","resource/journey/environmentMaps/3/nz.jpg"]);d.encoding=a.sc,e.background=d,e.environment=d,r.load("./resource/journey/models/FlightHelmet/glTF/FlightHelmet.gltf",(t=>{const n=t.scene;n.scale.set(10,10,10),n.position.set(0,-4,0),n.rotation.y=.5*-Math.PI,e.add(n),this.updateAllMaterial()}))}updateAllMaterial(){this.scene.traverse((e=>{e instanceof a.nb&&e.material instanceof a.lb&&(e.material.envMapIntensity=this.params.envMapIntensity,e.material.needsUpdate=!0,e.receiveShadow=!0,e.castShadow=!0)}))}onRender(){this.controls.update(),this.renderer.render(this.scene,this.camera);const e=this.clock.getElapsedTime();this.lastTimeStamp;this.lastTimeStamp=e}onDestroy(){var e;null===(e=this.gui)||void 0===e||e.destroy(),c.classList.remove("ended"),document.body.removeChild(c)}}}}]);
//# sourceMappingURL=19.min_2b93f37c54.js.map